/**
 * wordsearch.js
 *
 * Generate a wordsearch puzzle
 *
 * Author: Dave Eddy <dave@daveeddy.com>
 * Date: 2/24/13
 * @preserve
 */
(function(){function r(r,o,h,i){if(!r||!r.length)return!1;o=+o||20,h=+h||20,i=i||{},i.backwards=i.hasOwnProperty("backwards")?i.backwards:.5,r=r.filter(function(r){return t.test(r)}),r.sort(function(r,a){return r.length<a.length?-1:1});for(var d=Array(h),l=0;d.length>l;l++)d[l]=Array(o);for(var f=[],m=0,l=0;r.length>l;l++){var x=originalword=r[l];Math.random()<i.backwards&&(x=x.split("").reverse().join(""));for(var g=0;e>g;){var s=Math.floor(4*Math.random()),c=a(x,s,o,h);if(0>c.maxx||0>c.maxy||c.maxy<c.miny||c.maxx<c.minx){f.push(originalword);break}for(var u=ox=Math.round(Math.random()*(c.maxx-c.minx)+c.minx),y=oy=Math.round(Math.random()*(c.maxy-c.miny)+c.miny),v=!0,w=0,b=0;x.length>b;b++){var k=d[y][u];if(k){if(k!==x.charAt(b)){v=!1;break}w++}y+=c.dy,u+=c.dx}if(v&&!(w>=x.length)){u=ox,y=oy;for(var b=0;x.length>b;b++)d[y][u]=x.charAt(b),i.color&&(d[y][u]="["+(m+41)+"m"+d[y][u]+"[0m"),y+=c.dy,u+=c.dx;break}g++}g>=20&&f.push(originalword),m=(m+1)%6}for(var p=JSON.parse(JSON.stringify(d)),l=0;d.length>l;l++)for(var M=0;d[l].length>M;M++)d[l][M]||(p[l][M]=" ",d[l][M]=n.charAt(Math.floor(Math.random()*n.length)));return{grid:d,solved:p,unplaced:f}}function a(r,a,n,t){var e=0,o=0,h=n-1,i=t-1,d=0,l=0;switch(a){case 0:i=t-1,o=r.length-1,l=-1,h=n-r.length,e=0,d=1;break;case 1:h=n-r.length,e=0,d=1;break;case 2:o=0,i=t-r.length,l=1,h=n-r.length,e=0,d=1;break;case 3:o=0,i=t-r.length,l=1;break;default:}return{maxx:h,maxy:i,minx:e,miny:o,dx:d,dy:l}}var n="abcdefghijklmnopqrstuvwxyz",t=/^[a-z]+$/,e=20;"undefined"==typeof exports?window.wordsearch=r:module.exports=r})();